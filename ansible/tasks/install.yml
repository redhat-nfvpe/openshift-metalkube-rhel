---
- name: Enable internal repo for CRI-o
  yum_repository:
    name: crio
    description: CRI-O repo
    baseurl: https://cbs.centos.org/repos/paas7-crio-113-candidate/x86_64/os
    enabled: yes
    gpgcheck: no

- name: Enable internal repo for hyperkube
  yum_repository:
    name: hyperkube
    description: Hyperkube repo
    baseurl: https://rpms.svc.ci.openshift.org/openshift-origin-v4.1/
    enabled: yes
    gpgcheck: no

- name: Install openshift support packages
  package:
    name: "{{ openshift_node_support_packages | join(',') }}"
    update_cache: true
  async: 3600
  poll: 30

- name: Install openshift packages
  package:
    name: "{{ openshift_node_packages | join(',') }}"
    state: "{{ openshift_node_package_state }}"
  async: 3600
  poll: 30

- name: Enable the CRI-O service
  systemd:
    name: "cri-o"
    enabled: yes
